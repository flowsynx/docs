---
sidebar_position: 2
title: Workflow Schema
description: Learn how to configure FlowSynx, including setting up environment variables, customizing application settings, and preparing the API for seamless integration.
---

# FlowSynx Workflow Definition Schema
This schema defines a **Directed Acyclic Graph (DAG)** workflow as a single JSON object. The workflow consists of **tasks** (graph nodes) connected by **dependencies** (edges). The JSON document specifies **global workflow configuration**, **task-level settings**, **error-handling strategies**, and optional **manual approvals**.

## Top-Level Structure

A workflow definition is a single JSON object with a "Schema" URL and a nested "Workflow" object:

```jsonc
{
  "Schema": "https://schema.flowsynx.io/workflows/...",
  "Workflow": {
    "Name": "...",              // required
    "Description": "...",       // optional
    "Variables": { ... }        // optional
    "Configuration": { ... },   // optional global settings
    "Tasks": [ ... ]            // required list of task objects
  }
}
```

### Fields

| Field      | Type   | Required | Default | Description                                     |
| ---------- | ------ | -------- | ------- | ----------------------------------------------- |
| `Schema`   | string | ✅        | —       | URL identifying the JSON schema for validation. |
| `Workflow` | object | ✅        | —       | Object containing the workflow definition.      |

> FlowSynx workflow schemas are available at: [https://schema.flowsynx.io](https://schema.flowsynx.io)

### Workflow Object

The "Workflow" object contains the actual workflow definition with the following fields:

| Field           | Type   | Required | Default | Description                                                    |
| --------------- | ------ | -------- | ------- | -------------------------------------------------------------- |
| `Name`          | string | ✅        | —       | Unique name of the workflow.                                   |
| `Description`   | string | ❌        | null    | Human-readable description of the workflow’s purpose.          |
| `Variables`     | object | ❌        | `{}`    | Dictionary of key-value pairs for workflow-level variables.    |
| `Configuration` | object | ❌        | `{}`    | Global execution settings such as parallelism and error rules. |
| `Tasks`         | array  | ✅        | `[]`    | Array of task objects defining the DAG.                        |

## Variables Object

The `Variables` object is a dictionary that allows you to define key-value pairs for workflow-level variables. These variables can be referenced throughout the workflow.

```jsonc
"Variables": {
  "InputPath": "s3://bucket/input",
  "MaxRetries": 5,
  "EnableLogging": true
}
```

## Configuration Object

`Configuration` sets global execution rules.

```jsonc
"Configuration": {
  "DegreeOfParallelism": 3,
  "ErrorHandling": { ... },
  "TimeoutMilliseconds": 600000
}
```

| Key                               | Type    | Required  | Default | Meaning                                                          |
| --------------------------------- | ------- | --------- | ------- | ---------------------------------------------------------------- |
| `DegreeOfParallelism`             | integer | ❌        | 3       | Maximum number of tasks running at the same time.                |
| `ErrorHandling`                   | object  | ❌        | `{}`    | Default error-handling strategy for all tasks unless overridden. |
| `TimeoutMilliseconds`             | integer | ❌        | null    | Maximum total runtime (milliseconds) for the entire workflow.    |

## ErrorHandling Object
Controls what happens when a task fails.

```jsonc
"ErrorHandling": {
  "Strategy": "Retry",
  "TriggerPolicy": { ... }
  "RetryPolicy": { ... }
}
```

| Key             | Type   | Required | Default | Description                            |
| ---------------| ------ | -------- | --------| -------------------------------------- |
| `Strategy`      | enum   | ❌       | "Abort" | One of `"Retry"`, `"Skip"`, `"Abort"` or `"TriggerTask"`. |
| `TriggerPolicy` | object | ❌       | null    | Specifies the task to trigger when Strategy is "TriggerTask". |
| `RetryPolicy`   | object | ❌       | `{}`    | Used only if `Strategy` is `"Retry"`.  |

### TriggerPolicy

```jsonc
"TriggerPolicy": {
  "TaskName": "NotifyAdmin"
}
```

| Key             | Type   | Required | Description                              |
| ---------------| ------ | -------- | --------------------------------------   |
| `TaskName`      | string   | ✅       | The name of the task to be triggered.  |

### RetryPolicy

```jsonc
"RetryPolicy": {
  "MaxRetries": 3,
  "BackoffStrategy": "Fixed",
  "InitialDelayMilliseconds": 1000,
  "MaxDelayMilliseconds": 10000,
  "BackoffCoefficient": 2.0
}
```

| Key                              | Type    | Default | Description                                                |
| -------------------------------- | ------- | ------- | ---------------------------------------------------------- |
| `MaxRetries`                     | integer | 3       | Maximum retry attempts.                                    |
| `BackoffStrategy`                | enum    | "Fixed" | One of `"Fixed"`, `"Linear"`, `"Exponential"`, `"Jitter"`. |
| `InitialDelayMilliseconds`       | integer | 1000    | Delay (ms) before first retry.                             |
| `MaxDelayMilliseconds`           | integer | 10000   | Maximum allowed delay (ms) between retries.                |
| `BackoffCoefficient`             | number  | 2.0     | Growth factor for linear or exponential backoff.           |

#### BackoffStrategy Enum

- **Fixed**: Always wait InitialDelay between retries.
- **Linear**: Increase delay linearly with each retry.
- **Exponential**: Exponentially increase delay using BackoffCoefficient.
- **Jitter**: Add randomness to delay to avoid retry storms.

## Task Array
The `Tasks` array describes every node of the DAG.

Each task is an object:

```jsonc
{
  "Name": "ExtractData",
  "Description": "...",
  "Type": "Plugin.DataExtractor:1.0.0",
  "Execution": { ... },
  "FlowControl": { ... }
  "ErrorHandling": { ... },
  "ManualApproval": { ... },
  "Output": "extractedData",
  "Position": { "X": 100, "Y": 50 }
}
```

| Key              | Type     | Required  | Default     | Description                                                           |
| ---------------- | -------  | --------- | ------------| --------------------------------------------------------------------- |
| `Name`           | string   | ✅        | ""          | Unique identifier for the task.                                       |
| `Description`    | string   | ❌        | `null`      | Optional documentation.                                               |
| `Type`           | string   | ✅        | ""          | Identifier or configuration describing how the task runs.             |
| `Execution`      | object   | ✅        | `{}`        | Configuration settings related to execution behavior (see below).     |
| `FlowControl`    | object   | ❌        | `{}`        | Configuration settings for flow control and dependencies (see below). |
| `ErrorHandling`  | object   | ❌        | `null`      | Task-specific error handling, same format as global `ErrorHandling`.  |
| `ManualApproval` | object   | ❌        | `null`      | Details for manual human approval (see below).                        |
| `Output`         | string   | ❌        | ""          | Name of variable or key where this task’s output will be stored.      |
| `Position`       | object   | ❌        | `{X:0,Y:0}` | Visual coordinates for DAG rendering.                                 |

### Execution Object
The Execution object defines the configuration settings related to execution behavior.

```jsonc
"Execution": {
  "Operation": "read",
  "Specification": { ... },
  "Parameters": { ... },
  "Agent": { ... },
  "TimeoutMilliseconds": 30000
}
```

| Key	                |Type	    | Required	| Default	| Description                                                |
| ------------------- | ------- | --------- | --------| ---------------------------------------------------------- |
| Operation	          | string	| ✅	       | ""	     | The operation to be performed by the task.                 |
| Specification	      | object	| ❌	       | `{}`	   | Arbitrary key-value pairs for task-specific configuration. |
| Parameters	        | object	| ❌	       | `{}`	   | Arbitrary key-value pairs passed to the task executor.     |
| Agent	              | object	| ❌	       | `null`	 | Configuration for the agent executing the task.            |
| TimeoutMilliseconds	| integer	| ❌	       | `null`	 | Maximum runtime for this task in milliseconds.             |

### FlowControl Object
The FlowControl object defines the configuration settings for flow control and dependencies.

```jsonc
"FlowControl": {
  "Dependencies": ["TaskA"],
  "RunOnFailureOf": ["TaskB"],
  "ExecutionCondition": { ... },
  "ConditionalBranches": [ ... ]
}
```

| Key	                | Type	   | Required	  | Default	| Description                                                      |
| ------------------- | -------- | ---------- | --------| ---------------------------------------------------------------- |
| Dependencies	      | string[] | ❌	       | `[]`	  | Names of tasks that must finish before this one starts.          |
| RunOnFailureOf	    | string[] | ❌	       | `[]`	  | Names of tasks that trigger this task upon their failure.        |
| ExecutionCondition  | object	 | ❌	       | `null`	| Condition that must be met for this task to execute (see below). |
| ConditionalBranches	| object[] | ❌	       | `[]`	  | Conditional branches for dynamic task execution (see below).     |

### Condition Object
The Condition object defines an expression that must evaluate to true for the task to execute.

```jsonc
"ExecutionCondition": {
  "Expression": "$[Variables['IsEnabled'] == true]",
  "Description": "Check if the task is enabled"
}
```

| Key	        | Type	 | Required | Description                              |
| ----------- | ------ | -------- | ---------------------------------------- |
| Expression  | string | ✅	     | Logical expression to evaluate.          |
| Description	| string | ❌	     | Optional description of the condition.   |

### ConditionalBranch Object
The ConditionalBranch object defines a branch that executes a specific task based on a condition.

```jsonc
"ConditionalBranches": [
  {
    "Expression": "$[Variables['Condition'] == 'A']",
    "Description": "Branch A",
    "TargetTaskName": "TaskA"
  }
]
```

| Key	           | Type	  | Required | Description                                         |
| -------------- | ------ | -------- | --------------------------------------------------- |
| Expression     | string | ✅	     | Logical expression to evaluate.                      |
| Description	   | string | ❌	     | Optional description of the branch.                  |
| TargetTaskName | string | ✅	     | Name of the task to execute if the condition is met. |

### ManualApproval Object

Defines an optional human-in-the-loop step.

```jsonc
"ManualApproval": {
  "Enabled": true,
  "Comment": "Review the data",
}
```

| Key        | Type          | Default | Description                                                        |
| -----------| ------------- | ------- | ------------------------------------------------------------------ |
| `Enabled`  | boolean       | false   | If true, the task waits for human approval before continuing.      |
| `Comment`  | string        | ""      | Guidance for approvers.                                            |

### Position Object

Used purely for visualization.

```jsonc
"Position": { "X": 100, "Y": 50 }
```

| Key | Type    | Description                           |
| --- | ------  | ------------------------------------- |
| X   | integer | Horizontal coordinate (finite number) |
| Y   | integer | Vertical coordinate (finite number)   |

## Execution Semantics

1.  **DAG Dependency**: Each task runs only when every name listed in its `Dependencies` array has successfully completed (or been skipped based on error strategy).
2.  **Parallelism**: At most `DegreeOfParallelism` tasks run simultaneously, provided their dependencies are satisfied.
3.  **Error Handling**:
    -   A task's own `ErrorHandling` (if present) overrides the global setting.
    -   The engine applies retry logic when `Strategy` is `"Retry"`.
4.  **Manual Approval**: When `ManualApproval.Enabled` is true, execution pauses until an approver responds or a timeout triggers the `DefaultAction`.

## Example JSON Workflow

```json
{
  "Schema": "https://schema.flowsynx.io/workflows/v1.2.1/schema.camel.json",
  "Workflow": {
    "Name": "DataProcessingWorkflow",
    "Description": "Loading data from Amazon S3, convert it to CSV and then store it on Local FileSystem",
    "Configuration": {
      "DegreeOfParallelism": 4,
      "TimeoutMilliseconds": 600000,
      "ErrorHandling": {
        "Strategy": "Retry",
        "RetryPolicy": {
          "MaxRetries": 5,
          "BackoffStrategy": "Exponential",
          "InitialDelayMilliseconds": 2000,
          "MaxDelayMilliseconds": 30000,
          "BackoffCoefficient": 2.5
        }
      }
    },
    "Tasks": [
      {
        "Name": "AmazonFilesList",
        "Type": "FlowSynx.Cloud.Amazon.S3:1.1.0",
        "Execution": {
          "Operation": "list",
          "Specification": {
            "AccessKey": "AKIAEXAMPLE123456",
            "SecretKey": "abc123secretkeyexample",
            "Region": "us-east-1",
            "Bucket": "my-flowsynx-bucket",
            "SessionToken": "FQoGZXIvYXdzEJr..."
          },
          "Parameters": {
            "Path": "documents/report.json",
            "Recurse": true,
            "CaseSensitive": false,
            "MaxResults": 10
          }
        },
        "Position": { "X": 100, "Y": 50 }
      },
      {
        "Name": "ToCSV",
        "Type": "FlowSynx.Data.Csv:1.2.0",
        "Execution": {
          "Operation": "read",
          "Parameters": { 
            "Delimiter": ","
          }
        },
        "FlowControl": {
          "Dependencies": ["AmazonFilesList"]
        },
        "Position": { "X": 300, "Y": 50 }
      },
      {
        "Name": "SaveData",
        "Type": "FlowSynx.Storage.Local:1.1.0",
        "Execution": {
          "Operation": "write",
          "Parameters": { 
            "path": "result.txt",
            "Data": "$[Outputs('ToCSV')]",
            "overwrite": true
          }
        },
        "FlowControl": {
          "Dependencies": ["ToCSV"]
        },
        "Position": { "X": 500, "Y": 50 }
      }
    ]
  }
}
```